 Plan to implement                                                                                                                                                                                                  │
│                                                                                                                                                                                                                    │
│ Unified Grid Editor — Implementation Spec                                                                                                                                                                          │
│                                                                                                                                                                                                                    │
│ Context                                                                                                                                                                                                            │
│                                                                                                                                                                                                                    │
│ The World Builder's Room Layout editor is currently crammed into a 500px drawer (RoomLayoutDrawer.tsx), making spatial editing awkward. Additionally, NPCs removed from a room's NPC list leave orphaned spawn     │
│ points in layout_data.spawns.                                                                                                                                                                                      │
│                                                                                                                                                                                                                    │
│ This spec redesigns the World Builder around a "grids all the way down" philosophy: the World Map and Room Map share a unified CSS grid framework with consistent visual language, tooling, and navigation.        │
│ Clicking a room on the world grid drills into a full-viewport room grid editor. A Back button returns to the world grid. The PixiJS LocalMapView (gameplay/combat) is not touched.                                 │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ Navigation Flow                                                                                                                                                                                                    │
│                                                                                                                                                                                                                    │
│ WORLD VIEW                              ROOM VIEW                                                                                                                                                                  │
│ ┌─────────────────────────────────┐     ┌──────────────────────┬────────────┐                                                                                                                                      │
│ │ [← Back] World Name    [Save]  │     │ [← Back] World > Room   [Save]   │                                                                                                                                        │
│ │ [Edit] [Move] [Delete]  Zoom±  │     │ [NPC] [Tile▾] [Erase]   Zoom±   │                                                                                                                                         │
│ │                                 │     │                      │            │                                                                                                                                      │
│ │   CSS Grid (10×10 default)      │ ──► │  CSS Grid (15×15)    │ Room Props │                                                                                                                                      │
│ │   Each cell = a room            │     │  Each cell = a tile  │ - Name     │                                                                                                                                      │
│ │   Click occupied → drill in     │     │  NPC drag targets    │ - Desc     │                                                                                                                                      │
│ │   Click empty → Add Room menu   │     │  Zone paint targets  │ - NPCs ⇄  │                                                                                                                                       │
│ │                                 │ ◄── │                      │ - Image    │                                                                                                                                      │
│ │                                 │     │                      │            │                                                                                                                                      │
│ └─────────────────────────────────┘     └──────────────────────┴────────────┘                                                                                                                                      │
│      (+Add Room → auto-navigate)              (← Back → world view)                                                                                                                                                │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ Bug Fix: Orphaned NPC Spawn Points                                                                                                                                                                                 │
│                                                                                                                                                                                                                    │
│ Root cause: RoomPropertiesPanel.handleRemoveNPC() (line ~259) and WorldEditor.handleNPCsConfirm() (line ~361) update room.npcs without cleaning layout_data.spawns.                                                │
│                                                                                                                                                                                                                    │
│ Fix: Add cleanOrphanedSpawns(layoutData, npcIds) utility to localMap.ts. Call it in both NPC removal paths.                                                                                                        │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ Constants Consolidation                                                                                                                                                                                            │
│                                                                                                                                                                                                                    │
│ New file: frontend/src/types/editorGrid.ts                                                                                                                                                                         │
│                                                                                                                                                                                                                    │
│ Single source of truth for all editor grid constants (separate from PixiJS gameplay constants in localMap.ts).                                                                                                     │
│                                                                                                                                                                                                                    │
│ EDITOR_GRID_SIZE      = { cols: 15, rows: 15 }  ← SINGLE constant for BOTH world and room grids                                                                                                                    │
│ EDITOR_GRID_CELL_SIZE = 120        (currently hardcoded in GridCanvas.tsx:45)                                                                                                                                      │
│ EDITOR_GRID_CELL_GAP  = 12         (currently hardcoded in GridCanvas.tsx:46)                                                                                                                                      │
│ EDITOR_ZOOM = { default: 1.0, min: 0.5, max: 2.0, buttonStep: 0.2, wheelStep: 0.1 }                                                                                                                                │
│ ZONE_TYPE_CONFIG = [water, wall, hazard, no-spawn]    (currently inline in RoomLayoutDrawer.tsx:35-46)                                                                                                             │
│ ZONE_CELL_COLORS = { water: 'bg-blue-500/40', ... }  (currently inline in RoomLayoutCanvas.tsx)                                                                                                                    │
│                                                                                                                                                                                                                    │
│ Both world and room grids use EDITOR_GRID_SIZE (15×15). World grid default changes from 10×10 → 15×15. Existing worlds are unaffected (grid grows dynamically to fit room placements, so extra cells are just      │
│ empty).                                                                                                                                                                                                            │
│                                                                                                                                                                                                                    │
│ localMap.ts keeps all PixiJS constants (LOCAL_MAP_TILE_SIZE, LOCAL_MAP_ZOOM, etc.) and re-exports EDITOR_GRID_SIZE as DEFAULT_LAYOUT_GRID_SIZE for backward compat with gameplay code.                             │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ Component Architecture                                                                                                                                                                                             │
│                                                                                                                                                                                                                    │
│ After implementation:                                                                                                                                                                                              │
│                                                                                                                                                                                                                    │
│ WorldEditor.tsx (orchestrator — editorView: 'world' | 'room')                                                                                                                                                      │
│   ├─ EditorHeader.tsx         NEW — breadcrumb, back, save, dirty indicator                                                                                                                                        │
│   ├─ EditorToolbar.tsx        NEW — adapts tools by mode (world vs room) + zoom                                                                                                                                    │
│   ├─[editorView === 'world']                                                                                                                                                                                       │
│   │   └─ WorldGridView.tsx    RENAMED from GridCanvas.tsx — toolbar removed                                                                                                                                        │
│   ├─[editorView === 'room']                                                                                                                                                                                        │
│   │   ├─ RoomGridView.tsx     NEW — full-viewport CSS grid, NPC placement, zone painting                                                                                                                           │
│   │   └─ RoomPropertiesPanel  MODIFIED — no Layout button, draggable NPCs, spawn cleanup                                                                                                                           │
│   ├─ NPCPickerModal           UNCHANGED                                                                                                                                                                            │
│   ├─ CellActionMenu           UNCHANGED                                                                                                                                                                            │
│   └─ RoomGalleryPicker        UNCHANGED                                                                                                                                                                            │
│                                                                                                                                                                                                                    │
│ Deleted:                                                                                                                                                                                                           │
│                                                                                                                                                                                                                    │
│ - RoomLayoutDrawer.tsx — absorbed into RoomGridView + EditorToolbar + RoomPropertiesPanel                                                                                                                          │
│ - RoomLayoutCanvas.tsx — superseded by RoomGridView (inherits its cell rendering logic)                                                                                                                            │
│                                                                                                                                                                                                                    │
│ New shared hook:                                                                                                                                                                                                   │
│                                                                                                                                                                                                                    │
│ - useGridViewport.ts — zoom/pan/isPanning state + derived cellSize/gap + mouse handlers. Used by both WorldGridView and RoomGridView.                                                                              │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ State Changes in WorldEditor                                                                                                                                                                                       │
│                                                                                                                                                                                                                    │
│ Added state:                                                                                                                                                                                                       │
│                                                                                                                                                                                                                    │
│ const [editorView, setEditorView] = useState<'world' | 'room'>('world');                                                                                                                                           │
│ const [activeRoomTool, setActiveRoomTool] = useState<RoomEditorTool>('npc-place');                                                                                                                                 │
│ const [selectedZoneType, setSelectedZoneType] = useState<ZoneType>('water');                                                                                                                                       │
│ const [selectedNpcId, setSelectedNpcId] = useState<string | null>(null);                                                                                                                                           │
│                                                                                                                                                                                                                    │
│ Removed state:                                                                                                                                                                                                     │
│                                                                                                                                                                                                                    │
│ // showLayoutDrawer — replaced by editorView === 'room'                                                                                                                                                            │
│                                                                                                                                                                                                                    │
│ Navigation triggers:                                                                                                                                                                                               │
│                                                                                                                                                                                                                    │
│ - Click occupied cell in world view → setSelectedRoom(room) + setEditorView('room')                                                                                                                                │
│ - Create New Room → create via API → setSelectedRoom(newRoom) + setEditorView('room')                                                                                                                              │
│ - Import from Gallery → import → setSelectedRoom(importedRoom) + setEditorView('room')                                                                                                                             │
│ - ← Back (in room view) → setEditorView('world') (selectedRoom stays for world grid highlight)                                                                                                                     │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ Room Adjacency & Isolation Indicators (World Grid)                                                                                                                                                                 │
│                                                                                                                                                                                                                    │
│ Currently, GridRoom.connections is always { north: null, south: null, east: null, west: null } — roomCardToGridRoom() never populates them. The blue connection dots in GridCanvas never render. During gameplay,  │
│ deriveExitsFromWorld() in localMapUtils.ts computes adjacency from grid positions at runtime.                                                                                                                      │
│                                                                                                                                                                                                                    │
│ Fix: Compute adjacency visually in the world grid editor.                                                                                                                                                          │
│                                                                                                                                                                                                                    │
│ Add a utility computeRoomAdjacency(rooms: GridRoom[]) that returns a map of room IDs → which directions have adjacent rooms. Used by WorldGridView to:                                                             │
│                                                                                                                                                                                                                    │
│ 1. Show connectors (blue bars) between cells that both contain rooms — same rendering as current connection indicators, but driven by actual grid position adjacency instead of the always-null connections field. │
│ 2. Show isolation warning on rooms with zero adjacent neighbors — subtle orange/amber border + small warning icon. Tooltip: "This room has no adjacent rooms and won't be reachable during gameplay."              │
│                                                                                                                                                                                                                    │
│ This is purely visual (no data model changes). The adjacency map is recomputed whenever rooms[] changes.                                                                                                           │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ Task Breakdown                                                                                                                                                                                                     │
│                                                                                                                                                                                                                    │
│ Task 1: Constants Consolidation + Bug Fix                                                                                                                                                                          │
│                                                                                                                                                                                                                    │
│ Scope: Foundation — extract hardcoded values, fix NPC removal bug.                                                                                                                                                 │
│                                                                                                                                                                                                                    │
│ Create:                                                                                                                                                                                                            │
│ - frontend/src/types/editorGrid.ts — all editor grid constants, single EDITOR_GRID_SIZE                                                                                                                            │
│                                                                                                                                                                                                                    │
│ Modify:                                                                                                                                                                                                            │
│ - frontend/src/types/localMap.ts                                                                                                                                                                                   │
│   - Add cleanOrphanedSpawns() utility                                                                                                                                                                              │
│   - Replace DEFAULT_LAYOUT_GRID_SIZE definition with re-export: export { EDITOR_GRID_SIZE as DEFAULT_LAYOUT_GRID_SIZE } from './editorGrid'                                                                        │
│ - frontend/src/components/world/GridCanvas.tsx — import EDITOR_GRID_CELL_SIZE, EDITOR_GRID_CELL_GAP, EDITOR_ZOOM                                                                                                   │
│ - frontend/src/components/world/RoomLayoutDrawer.tsx — import ZONE_TYPE_CONFIG from editorGrid                                                                                                                     │
│ - frontend/src/components/world/RoomLayoutCanvas.tsx — import ZONE_CELL_COLORS from editorGrid                                                                                                                     │
│ - frontend/src/api/worldApi.ts — import EDITOR_GRID_SIZE, use .cols/.rows for grid_width/grid_height (world default becomes 15×15)                                                                                 │
│ - frontend/src/views/WorldEditor.tsx — import EDITOR_GRID_SIZE, use for initial gridSize state; call cleanOrphanedSpawns() in handleNPCsConfirm                                                                    │
│ - frontend/src/components/world/RoomPropertiesPanel.tsx — call cleanOrphanedSpawns() in handleRemoveNPC                                                                                                            │
│ - backend/endpoints/world_card_endpoints_v2.py — update Form defaults from 10 to 15 (or make frontend authoritative)                                                                                               │
│                                                                                                                                                                                                                    │
│ Verify: World grid now defaults to 15×15. Room layout still 15×15. Both reference EDITOR_GRID_SIZE. Existing worlds unaffected (grid grows dynamically). NPC removal cleans spawns.                                │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ Task 2: useGridViewport Hook + EditorHeader + EditorToolbar                                                                                                                                                        │
│                                                                                                                                                                                                                    │
│ Scope: Extract shared zoom/pan into hook, create header and toolbar components.                                                                                                                                    │
│                                                                                                                                                                                                                    │
│ Create:                                                                                                                                                                                                            │
│ - frontend/src/hooks/useGridViewport.ts — zoom, pan, cellSize, gap, mouse handlers                                                                                                                                 │
│ - frontend/src/components/world/EditorHeader.tsx — breadcrumb (World > Room), back, save, dirty                                                                                                                    │
│ - frontend/src/components/world/EditorToolbar.tsx — mode-adaptive tools + zoom controls                                                                                                                            │
│   - World mode: Edit / Move / Delete (with E/M/D shortcuts)                                                                                                                                                        │
│   - Room mode: NPC Place / Tile Painter dropdown / Eraser + zoom                                                                                                                                                   │
│   - Tile Painter dropdown shows zone types from ZONE_TYPE_CONFIG                                                                                                                                                   │
│                                                                                                                                                                                                                    │
│ Modify:                                                                                                                                                                                                            │
│ - frontend/src/components/world/GridCanvas.tsx — replace inline zoom/pan with useGridViewport()                                                                                                                    │
│                                                                                                                                                                                                                    │
│ Verify: GridCanvas zoom/pan works identically via the hook.                                                                                                                                                        │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ Task 3: RoomGridView Component                                                                                                                                                                                     │
│                                                                                                                                                                                                                    │
│ Scope: Create the full-viewport room grid editor.                                                                                                                                                                  │
│                                                                                                                                                                                                                    │
│ Create:                                                                                                                                                                                                            │
│ - frontend/src/components/world/RoomGridView.tsx                                                                                                                                                                   │
│   - CSS Grid using EDITOR_GRID_CELL_SIZE × DEFAULT_ROOM_GRID_SIZE                                                                                                                                                  │
│   - Zoom/pan via useGridViewport                                                                                                                                                                                   │
│   - Room background image behind grid (from RoomLayoutCanvas pattern)                                                                                                                                              │
│   - NPC spawn rendering: portrait thumbnails in cells                                                                                                                                                              │
│   - Zone overlays: colored backgrounds per ZONE_CELL_COLORS                                                                                                                                                        │
│   - Exit indicators: arrows on edge tiles (from RoomLayoutCanvas)                                                                                                                                                  │
│   - NPC placement: HTML5 drag-and-drop (onDragOver/onDrop on cells)                                                                                                                                                │
│   - Zone painting: click-and-drag to paint, click painted cell to erase                                                                                                                                            │
│   - Tool mode from activeRoomTool prop controls interaction behavior                                                                                                                                               │
│                                                                                                                                                                                                                    │
│ Key props:                                                                                                                                                                                                         │
│ interface RoomGridViewProps {                                                                                                                                                                                      │
│   room: GridRoom;                                                                                                                                                                                                  │
│   layoutData: RoomLayoutData;                                                                                                                                                                                      │
│   npcs: Array<{ id: string; name: string; imageUrl?: string }>;                                                                                                                                                    │
│   activeTool: RoomEditorTool;                                                                                                                                                                                      │
│   selectedNpcId: string | null;                                                                                                                                                                                    │
│   selectedZoneType: ZoneType;                                                                                                                                                                                      │
│   exitDirections: ExitDirection[];                                                                                                                                                                                 │
│   viewport: GridViewportState;  // from useGridViewport                                                                                                                                                            │
│   onLayoutChange: (layoutData: RoomLayoutData) => void;                                                                                                                                                            │
│ }                                                                                                                                                                                                                  │
│                                                                                                                                                                                                                    │
│ Verify: Renders 15×15 grid with zoom/pan. NPCs can be drag-placed. Zones can be painted.                                                                                                                           │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ Task 4: WorldEditor Integration + Rename GridCanvas                                                                                                                                                                │
│                                                                                                                                                                                                                    │
│ Scope: Wire everything together. Implement navigation. Delete deprecated components.                                                                                                                               │
│                                                                                                                                                                                                                    │
│ Rename:                                                                                                                                                                                                            │
│ - GridCanvas.tsx → WorldGridView.tsx — remove embedded toolbar (now in EditorToolbar)                                                                                                                              │
│                                                                                                                                                                                                                    │
│ Modify:                                                                                                                                                                                                            │
│ - frontend/src/views/WorldEditor.tsx — major restructure:                                                                                                                                                          │
│   - Add editorView, activeRoomTool, selectedZoneType, selectedNpcId state                                                                                                                                          │
│   - Remove showLayoutDrawer state                                                                                                                                                                                  │
│   - Replace header JSX with <EditorHeader>                                                                                                                                                                         │
│   - Add <EditorToolbar> between header and canvas area                                                                                                                                                             │
│   - Conditional render: world → <WorldGridView>, room → <RoomGridView> + <RoomPropertiesPanel>                                                                                                                     │
│   - Navigation: occupied cell click → drill into room view                                                                                                                                                         │
│   - Create/import room → auto-navigate to room view                                                                                                                                                                │
│   - Back → return to world view                                                                                                                                                                                    │
│ - frontend/src/components/world/WorldGridView.tsx (post-rename):                                                                                                                                                   │
│   - Add computeRoomAdjacency(rooms) utility (or import from editorGrid.ts)                                                                                                                                         │
│   - Replace current connection indicators (which read always-null room.connections) with adjacency-based connectors — blue bars between cells that both contain rooms                                              │
│   - Add isolation warning: rooms with zero adjacent neighbors get amber border + warning icon + tooltip "This room has no adjacent rooms and won't be reachable"                                                   │
│   - Recompute adjacency whenever rooms[] prop changes (useMemo)                                                                                                                                                    │
│ - frontend/src/components/world/RoomPropertiesPanel.tsx:                                                                                                                                                           │
│   - Remove isCompact prop and Layout button                                                                                                                                                                        │
│   - Make NPC list items draggable (for drag onto RoomGridView)                                                                                                                                                     │
│   - Only rendered when editorView === 'room'                                                                                                                                                                       │
│                                                                                                                                                                                                                    │
│ Delete:                                                                                                                                                                                                            │
│ - frontend/src/components/world/RoomLayoutDrawer.tsx                                                                                                                                                               │
│ - frontend/src/components/world/RoomLayoutCanvas.tsx                                                                                                                                                               │
│                                                                                                                                                                                                                    │
│ Verify: Full walkthrough:                                                                                                                                                                                          │
│ 1. Open world editor → world grid + world toolbar                                                                                                                                                                  │
│ 2. Click empty cell → CellActionMenu → Create Room → navigates to room view                                                                                                                                        │
│ 3. Room grid fills center. Properties panel on right. Toolbar shows room tools.                                                                                                                                    │
│ 4. Drag NPC from panel to grid cell → spawn placed                                                                                                                                                                 │
│ 5. Select Tile Painter → paint water zones → zones render                                                                                                                                                          │
│ 6. Click Back → returns to world grid, room visible at position                                                                                                                                                    │
│ 7. Save → persists everything                                                                                                                                                                                      │
│ 8. NPC removal from panel cleans spawn points                                                                                                                                                                      │
│ 9. Two adjacent rooms on world grid show blue connector bars between them                                                                                                                                          │
│ 10. A room placed with no neighbors shows amber border + warning icon                                                                                                                                              │
│ 11. Moving a room next to another room updates connectors and clears isolation warning                                                                                                                             │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ Task Dependency Graph                                                                                                                                                                                              │
│                                                                                                                                                                                                                    │
│ Task 1 (Constants + Bug Fix)                                                                                                                                                                                       │
│     │                                                                                                                                                                                                              │
│     ▼                                                                                                                                                                                                              │
│ Task 2 (Hook + Header + Toolbar)                                                                                                                                                                                   │
│     │                                                                                                                                                                                                              │
│     ▼                                                                                                                                                                                                              │
│ Task 3 (RoomGridView)                                                                                                                                                                                              │
│     │                                                                                                                                                                                                              │
│     ▼                                                                                                                                                                                                              │
│ Task 4 (Integration + Cleanup)                                                                                                                                                                                     │
│                                                                                                                                                                                                                    │
│ Each task builds on the previous. Tasks are sized to complete well within a context window with room for debugging.                                                                                                │
│                                                                                                                                                                                                                    │
│ ---                                                                                                                                                                                                                │
│ Files Reference                                                                                                                                                                                                    │
│ ┌───────────────────────────────────────────────────────┬──────┬─────────────────────────────────────────────────┐                                                                                                 │
│ │                         File                          │ Task │                     Action                      │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/types/editorGrid.ts                      │ 1    │ CREATE                                          │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/types/localMap.ts                        │ 1    │ MODIFY (re-export, add cleanOrphanedSpawns)     │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/api/worldApi.ts                          │ 1    │ MODIFY (import EDITOR_GRID_SIZE)                │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ backend/endpoints/world_card_endpoints_v2.py          │ 1    │ MODIFY (update Form defaults 10→15)             │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/components/world/GridCanvas.tsx          │ 1,2  │ MODIFY (import constants, use hook)             │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/components/world/RoomLayoutDrawer.tsx    │ 1    │ MODIFY (import constants) → DELETE in Task 4    │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/components/world/RoomLayoutCanvas.tsx    │ 1    │ MODIFY (import constants) → DELETE in Task 4    │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/components/world/RoomPropertiesPanel.tsx │ 1,4  │ MODIFY (spawn cleanup, draggable NPCs)          │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/views/WorldEditor.tsx                    │ 1,4  │ MODIFY (spawn cleanup, navigation, restructure) │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/hooks/useGridViewport.ts                 │ 2    │ CREATE                                          │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/components/world/EditorHeader.tsx        │ 2    │ CREATE                                          │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/components/world/EditorToolbar.tsx       │ 2    │ CREATE                                          │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/components/world/WorldGridView.tsx       │ 4    │ RENAME from GridCanvas.tsx                      │                                                                                                 │
│ ├───────────────────────────────────────────────────────┼──────┼─────────────────────────────────────────────────┤                                                                                                 │
│ │ frontend/src/components/world/RoomGridView.tsx        │ 3    │ CREATE                                          │                                                                                                 │
│ └───────────────────────────────────────────────────────┴──────┴─────────────────────────────────────────────────┘                                                                                                 │
│ ---                                                                                                                                                                                                                │
│ Design Notes                                                                                                                                                                                                       │
│                                                                                                                                                                                                                    │
│ - Same grid size everywhere — EDITOR_GRID_SIZE = { cols: 15, rows: 15 } governs both world and room grids. One constant, one source of truth. "Grids all the way down."                                            │
│ - Same cell pixel size — both grids render cells at EDITOR_GRID_CELL_SIZE (120px at zoom 1.0), giving visual consistency.                                                                                          │
│ - Same zoom/pan behavior — both use useGridViewport hook with identical interaction patterns.                                                                                                                      │
│ - Tile Painter replaces world tools — when inside a room, the toolbar swaps Edit/Move/Delete for NPC Place/Tile Paint/Eraser. Zoom controls persist in both modes.                                                 │
│ - RoomPropertiesPanel only in room view — no floating panel at world level. At world level, room info is visible on the cell itself (name, NPC count).                                                             │
│ - Existing worlds unaffected — world grids grow dynamically to fit room placements. Changing the default from 10→15 just means new worlds start with more space. Existing worlds keep their actual room positions. │
│ - Future: world grid could use the same framework for richer editing — drag rooms between cells could use the same NPC drag pattern.   